# 虚拟内存

## 分段分页

- 分页和分段是实现离散分配存储方式，它们都需要地址转换机制实现地址变换，且访问指令（或数据）需要两次内存访问

但两者概念上存在明显的区别，主要表现为： 

- 页是信息的物理单位，分页仅是系统管理内存的方便而进行的，不是用户的需要；段是信息的逻辑单位，分段是出于用户的需要； 
- 页的大小固定的，具体由系统决定；段的大小不固定，由用户程序本身决定； 
- 分页的逻辑地址空间是一维的连续空间；分段的逻辑地址空间是二维的，段之间的逻辑地址是不连续的。



## 缺页中断

当软件试图访问已映射在虚拟地址空间中，但是目前并未被加载在物理内存中的一个分页时，由中央处理器的内存管理单元所发出的中断。

1. 保存CPU现场
2. 缺页中断的虚拟地址，操作系统检查这个地址是否有效
3. 检查是否有空闲页框。如果没有空闲页框，执行页面置换算法寻找一个页面来淘汰
4. 操作系统查找所需页面在磁盘上的地址，通过磁盘操作将其装入
5. CPU调度引发缺页中断的进程
6. 恢复CPU



## 页面置换

### 先进先出 FIFO

优先淘汰最早进入内存的页面

### 最近最久未使用 LRU

选择最近最长时间未访问过的页面予以淘汰

